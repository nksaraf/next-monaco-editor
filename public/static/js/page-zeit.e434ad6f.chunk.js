(this.csbJsonP=this.csbJsonP||[]).push([[37],{"./src/app/pages/PreviewAuth/index.tsx":function(e,t,n){"use strict";n.r(t);var r=n("../../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(r),s=n("../../node_modules/react/index.js"),a=n.n(s),i=n("./src/app/overmind/index.ts"),c=n("../../node_modules/react-router/esm/react-router.js"),l=n("../common/lib/components/flex/Centered.js"),u=n.n(l),d=n("../common/lib/components/flex/Fullscreen.js"),m=n.n(d),p=n("../common/lib/utils/url-generator.js"),h=n("./src/app/components/Title.ts");t.default=Object(c.o)(function(e){var t=Object(i.c)(),n=t.state,r=t.actions.genericPageMounted,l=t.effects,d=a.a.useState(),b=o()(d,2),g=b[0],f=b[1];return Object(s.useEffect)(function(){r()},[r]),Object(s.useEffect)(function(){if(n.hasLogIn){f(null);var t=e.match.params.id.split("-"),r=o()(t,2),s=r[0],a=r[1];l.api.getSandbox(s).then(function(e){var t=Object(p.frameUrl)(e,"",{port:a?Number.parseInt(a,10):void 0}),n=new URL(t).origin;window.addEventListener("message",function t(r){r.data&&"request-preview-secret"===r.data.$type&&(r.source.postMessage({$type:"preview-secret",previewSecret:e.previewSecret},n),window.removeEventListener("message",t))})}).catch(function(e){f("We couldn't find the sandbox")})}},[l.api,e.match.params.id,n.hasLogIn]),n.hasLogIn?a.a.createElement(m.a,{style:{height:"100vh"}},a.a.createElement(u.a,{horizontal:!0,vertical:!0},a.a.createElement(h.a,null,g?"Error: "+g:"Fetching Sandbox"))):a.a.createElement(c.c,{to:Object(p.signInPageUrl)(location.pathname)})})},"./src/app/pages/ZeitAuth/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return O});var r=n("../../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(r),s=n("../../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("../../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(i),l=n("../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),u=n.n(l),d=n("../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(d),p=n("../../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=n.n(p),b=n("../../node_modules/@babel/runtime/helpers/inherits.js"),g=n.n(b),f=n("../../node_modules/@babel/runtime/helpers/defineProperty.js"),j=n.n(f),w=n("../../node_modules/react/index.js"),v=n.n(w),x=n("../common/lib/components/flex/Centered.js"),_=n.n(x),E=n("../common/lib/utils/url-generator.js"),y=n("./src/app/components/Title.ts"),O=function(e){function t(e){var n;a()(this,t),n=u()(this,m()(t).call(this,e)),j()(h()(n),"getMessage",function(){return n.state.redirect?(document.location.href=Object(E.newSandboxUrl)(),"Redirecting to sandbox page"):n.state.error?"Something went wrong while signing in: ".concat(n.state.error):n.state.jwt?"Signing in...":null==n.state.jwt?(setTimeout(function(){document.location.href=Object(E.signInUrl)()},2e3),"Redirecting to sign in page..."):"Hey"});var r=document.location.search.match(/\?code=(.*)/),s=o()(r,2),i=(s[0],s[1]);return i?window.opener?(window.opener.location.origin===window.location.origin&&window.opener.postMessage({type:"signin",data:{code:i}},Object(E.protocolAndHost)()),u()(n)):(n.state={redirect:"/"},u()(n)):(n.state={error:"no message received"},n)}return g()(t,e),c()(t,[{key:"render",value:function(){return v.a.createElement(_.a,{horizontal:!0,vertical:!0},v.a.createElement(y.a,null,this.getMessage()))}}]),t}(v.a.PureComponent)}}]);
//# sourceMappingURL=page-zeit.e434ad6f.chunk.js.map