<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="https://codesandbox.io/static/fonts/inter/inter.css"/><style data-href="/styles.8595b7ad32c1d6ac087d.css">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{-webkit-box-sizing:content-box;box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box;overflow-y:scroll}*,:after,:before{-webkit-box-sizing:inherit;box-sizing:inherit}body{font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0}h1{font-size:2.15rem}h1,h2{padding:0;margin:0 0 1.0875rem;color:inherit;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.58293rem}h3{font-size:1.35824rem}h3,h4{padding:0;margin:0 0 1.0875rem;color:inherit;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85805rem}h5,h6{padding:0;margin:0 0 1.0875rem;color:inherit;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.79482rem}hgroup{padding:0;margin:0 0 1.0875rem}ol,ul{padding:0;margin:0 0 1.0875rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.0875rem}pre{font-size:.85rem}pre,table{padding:0;margin:0 0 1.0875rem;line-height:1.45rem}table{font-size:1rem;border-collapse:collapse;width:100%}fieldset{padding:0;margin:0 0 1.0875rem}blockquote{padding:0;margin:0 1.45rem 1.0875rem}form,iframe,noscript{padding:0;margin:0 0 1.0875rem}hr{padding:0;margin:0 0 calc(1.0875rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.0875rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.54375rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.54375rem;margin-top:.54375rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.54375rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}h1,h2,h3,h4{line-height:1.2}@media only screen and (max-width:768px){html{font-size:106.25%}}@media only screen and (max-width:480px){html{font-size:100%}}body,html{text-rendering:optimizeLegibility;font-smooth:always;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;min-height:100%;-webkit-text-size-adjust:100%;height:100%;background:#040404;font-size:16px;color:#fff;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue}@media (-webkit-max-device-pixel-ratio:1.25),(max-resolution:120dpi),screen and (-webkit-max-device-pixel-ratio:1.3){body,html{-webkit-font-smoothing:antialiased;-moz-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-smoothing:antialiased}}*{-webkit-transition:color,background-color .2s ease;transition:color,background-color .2s ease}input{-webkit-font-smoothing:antialiased;-moz-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-smoothing:antialiased;text-rendering:optimizeLegibility;font-smooth:always;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}.disable-hover,.disable-hover *{pointer-events:none!important}iframe{margin-bottom:0}a{color:#40a9f3}.gatsby-resp-image-image{-webkit-box-shadow:none!important;box-shadow:none!important}.gatsby-resp-image-background-image{background-image:none!important}twitter-widget{margin-left:auto;margin-right:auto}@media (prefers-reduced-motion:reduce){*,:after,:before{-webkit-animation-duration:1ms!important;animation-duration:1ms!important;-webkit-transition-duration:1ms!important;transition-duration:1ms!important}}</style><meta name="generator" content="Gatsby 2.13.72"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><style data-styled="erAYjS fjUYIT ffjqnA hrQEdM iVCfuj liJZto kGLnEc dRznav bVAwCL kyilLh cKmXFd gATgEi hUWNdk gNoZef dKBugp ktnsV dGELJG iqVNPM cEWHQa chCInC gJVXgH jjtOWa bwnAMd hHFJvc kzxyPu hajUBy cWWqEe brInaT dIuYjC" data-styled-version="4.4.1">
/* sc-component-id: style__VisuallyHidden-sc-17p0o6p-3 */
.erAYjS{border:0;-webkit-clip:rect(0 0 0 0);clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;}
/* sc-component-id: Button__Link-yto3pm-1 */
.kyilLh{background:#0971f1;border-radius:0.25rem;border:none;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue';font-size:0.8125rem;line-height:19px;text-align:center;padding:4px 21px;font-weight:500;-webkit-text-decoration:none;text-decoration:none;color:#fff !important;-webkit-transition:all 200ms ease;transition:all 200ms ease;box-shadow:0px 2px 4px rgba(0,0,0,0.1);display:inline-block;} .kyilLh:disabled{opacity:0.4;} .kyilLh:hover{box-shadow:0px 2px 8px rgba(0,0,0,0.24);-webkit-transform:scale(1.05);-ms-transform:scale(1.05);transform:scale(1.05);} .kyilLh:focus{box-shadow:0px 2px 8px rgba(0,0,0,0.24);-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1);}
/* sc-component-id: elements__Header-sc-1fad1na-0 */
.fjUYIT{box-shadow:0px 1px 0px #242424;height:48px;width:100%;background:#040404;}
/* sc-component-id: elements__Nav-sc-1fad1na-2 */
.ffjqnA{width:1081px;max-width:90%;margin:auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;font-size:0.8125rem;} @media only screen and (max-width:768px){.ffjqnA{display:none;}} @media only screen and (max-width:1024px){.ffjqnA .tablet-remove{display:none;}}
/* sc-component-id: elements__Wrapper-sc-1fad1na-3 */
.hrQEdM{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}
/* sc-component-id: elements__LogoWrapper-sc-1fad1na-5 */
.iVCfuj{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue';display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:0.8125rem;margin-right:4rem;color:white;-webkit-text-decoration:none;text-decoration:none;} @media screen and (max-width:900px){.iVCfuj{margin-right:2rem;}}
/* sc-component-id: elements__LogoImage-sc-1fad1na-6 */
.liJZto{margin-right:1rem;}
/* sc-component-id: elements__List-sc-1fad1na-7 */
.kGLnEc{list-style:none;margin:0;padding:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;} .kGLnEc li{margin:0;} .kGLnEc li:not(:last-child){margin-right:3rem;} @media screen and (max-width:900px){.kGLnEc li:not(:last-child){margin-right:1.5rem;}} .kGLnEc a:not(.button),.kGLnEc button{background:transparent;border:none;cursor:pointer;-webkit-text-decoration:none;text-decoration:none;color:#999;-webkit-transition:all 200ms ease;transition:all 200ms ease;outline:none;padding:0;} .kGLnEc a:not(.button):hover,.kGLnEc button:hover{color:#fff;} .kGLnEc a:not(.button):hover svg path,.kGLnEc button:hover svg path{fill:#fff;}
/* sc-component-id: elements__LogIn-sc-1fad1na-8 */
.bVAwCL{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}
/* sc-component-id: elements__MobileNav-sc-1fad1na-9 */
.cKmXFd{display:none;padding-left:1rem;padding-right:1rem;margin:auto;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;height:100%;position:relative;z-index:3;background:#040404;} @media only screen and (max-width:768px){.cKmXFd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}} .cKmXFd > div{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;} .cKmXFd > div > svg{cursor:pointer;} .cKmXFd > div > a{font-style:normal;font-weight:500;font-size:1rem;-webkit-text-decoration:none;text-decoration:none;margin-right:1rem;color:#fff;}
/* sc-component-id: Navigation___StyledSvg-h33bys-0 */
.dRznav{margin-left:0.25rem;top:-1px;position:relative;}
/* sc-component-id: Typography__P-xlq88a-1 */
.hajUBy{font-weight:normal;font-size:1.125rem;line-height:1.3;color:#fff;margin:0;margin-bottom:1rem;font-size:1.4375rem;font-size:1.5rem;}.cWWqEe{font-weight:normal;font-size:1.125rem;line-height:1.3;color:#fff;margin:0;margin-bottom:1rem;font-size:0.875rem;color:#999;}
/* sc-component-id: elements__FooterWrapper-sc-9c2o28-0 */
.hHFJvc{padding-bottom:1rem;margin-top:6rem;margin-bottom:3rem;}
/* sc-component-id: elements__Nav-sc-9c2o28-1 */
.kzxyPu{padding-top:2.5rem;border-top:1px solid #242424;display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));grid-gap:3rem;max-width:80%;width:1200px;margin:auto;margin-bottom:4.5rem;} .kzxyPu a{color:inherit;-webkit-text-decoration:none;text-decoration:none;} .kzxyPu a:hover{color:#fff;} .kzxyPu ul{padding:0;margin:0;list-style:none;} .kzxyPu ul li:first-child{margin-bottom:1rem;}
/* sc-component-id: elements__Social-sc-9c2o28-2 */
.brInaT{display:grid;grid-gap:1rem;grid-template-columns:repeat(3,1rem);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:0;margin:0;list-style:none;} .brInaT svg path{-webkit-transition:all 200ms ease;transition:all 200ms ease;} .brInaT svg:hover path{fill:#fff;}
/* sc-component-id: Footer___StyledP-wcuxep-0 */
.dIuYjC{font-weight:normal;font-size:1.125rem;line-height:1.3;color:#fff;margin:0;margin-bottom:1rem;font-size:0.875rem;color:#999;text-align:center;}
/* sc-component-id: sc-bdVaJa */
.hUWNdk{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:0 2rem;width:100%;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;} @media (max-width:768px){.hUWNdk{padding:0;}}
/* sc-component-id: sc-bwzfXH */
.gNoZef{width:100%;max-width:800px;}
/* sc-component-id: sc-htpNat */
.dKBugp{padding:4.5rem 0rem 1rem 0rem;box-sizing:border-box;}
/* sc-component-id: PostElements__Container-sc-1nhtqd7-0 */
.gATgEi{color:rgba(255,255,255,0.9);margin-bottom:1rem;}
/* sc-component-id: PostElements__Title-sc-1nhtqd7-1 */
.ktnsV{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue';font-weight:600;font-size:1.25rem;line-height:1.2;margin-bottom:1rem;color:#f2f2f2;}
/* sc-component-id: PostElements__PostDate-sc-1nhtqd7-2 */
.gJVXgH{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue';font-weight:500;font-size:14px;color:#b8b9ba;display:block;margin-bottom:0.5rem;}
/* sc-component-id: PostElements__AuthorImage-sc-1nhtqd7-3 */
.cEWHQa{width:32px;height:32px;border-radius:4px;margin-right:1rem;}
/* sc-component-id: PostElements__Author-sc-1nhtqd7-4 */
.chCInC{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue';font-weight:500;font-size:18px;margin:0;color:#f2f2f2;}
/* sc-component-id: _postelements__PostContainer-sc-1otmru8-0 */
.bwnAMd{margin:auto;color:#fff;overflow:hidden;line-height:1.7;font-weight:500;font-size:18px;color:rgba(255,255,255,0.9);} .bwnAMd h1,.bwnAMd h2,.bwnAMd h3,.bwnAMd h4,.bwnAMd h5,.bwnAMd h6{color:#fff;font-weight:800;} .bwnAMd h2{margin-top:3rem;font-size:28px;} .bwnAMd h3{margin-top:3.5rem;margin-bottom:1.5rem;font-size:26px;} .bwnAMd h4{margin-top:2rem;margin-bottom:0.5rem;font-size:20px;font-weight:600;} .bwnAMd ul,.bwnAMd ol{margin-bottom:28px;} .bwnAMd p{margin-bottom:28px;word-break:break-word;} .bwnAMd p,.bwnAMd li{color:rgba(255,255,255,0.8);} .bwnAMd img{display:block;margin:20px auto;} .bwnAMd figcaption{text-align:center;color:rgba(255,255,255,0.6);} .bwnAMd a{color:#66b9f4;}
/* sc-component-id: _postelements__Image-sc-1otmru8-1 */
.jjtOWa{display:block;margin:20px auto;}
/* sc-component-id: _postelements__MetaData-sc-1otmru8-2 */
.dGELJG{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}
/* sc-component-id: _postelements__AuthorContainer-sc-1otmru8-3 */
.iqVNPM{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:0.5rem;}</style><title data-react-helmet="true">How we make npm packages work in the browser - CodeSandbox Blog</title><meta data-react-helmet="true" name="og:title" content="How we make npm packages work in the browser - CodeSandbox Blog"/><meta data-react-helmet="true" name="description" content="We upgraded our npm support to be 99.98% cheaper and 2,000% faster using serverless."/><meta data-react-helmet="true" name="og:description" content="We upgraded our npm support to be 99.98% cheaper and 2,000% faster using serverless."/><meta data-react-helmet="true" name="twitter:description" content="We upgraded our npm support to be 99.98% cheaper and 2,000% faster using serverless."/><meta data-react-helmet="true" name="og:image" content="/static/banner-349d1f8eed7441b2a4f8902528c07633.png"/><meta data-react-helmet="true" name="twitter:image:src" content="/static/banner-349d1f8eed7441b2a4f8902528c07633.png"/><meta data-react-helmet="true" name="keywords" content="react, codesandbox, editor, vue, angular, ide, code, javascript, playground, sharing, spa, single, page, application, web, application, frontend, front, end"/><meta data-react-helmet="true" name="referrer" content="origin"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:author" content="https://codesandbox.io"/><meta data-react-helmet="true" name="theme-color" content="#040404"/><meta data-react-helmet="true" property="og:image:width" content="1200"/><meta data-react-helmet="true" property="og:image:height" content="630"/><meta data-react-helmet="true" property="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" property="twitter:site" content="@codesandbox"/><meta data-react-helmet="true" property="twitter:creator" content="@codesandbox"/><meta data-react-helmet="true" property="twitter:image:width" content="1200"/><meta data-react-helmet="true" property="twitter:image:height" content="630"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl+'';f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer', 'GTM-T3L6RFK');</script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400|Roboto:400i,400&amp;display=swap" rel="stylesheet"/><link as="script" rel="preload" href="/component---src-templates-post-js-85254caf75885945d366.js"/><link as="script" rel="preload" href="/app-a8a2381ab2d52452ce71.js"/><link as="script" rel="preload" href="/styles-ca0dba639b1e1a681fbe.js"/><link as="script" rel="preload" href="/2-e46c10da8621f2227475.js"/><link as="script" rel="preload" href="/3-68f281170fa1642b2afc.js"/><link as="script" rel="preload" href="/1-3a3464f5ff7af0c42398.js"/><link as="script" rel="preload" href="/webpack-runtime-edbf8c97e8ef6830faf6.js"/><link as="fetch" rel="preload" href="/page-data/post/how-we-make-npm-packages-work-in-the-browser/page-data.json" crossorigin="anonymous"/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T3L6RFK" height="0" width="0" style="display: none; visibility: hidden"></iframe></noscript><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div><div style="position:absolute;left:0;right:0;z-index:10"><a href="#main" class="style__VisuallyHidden-sc-17p0o6p-3 erAYjS">Skip to main content</a></div><div><div style="opacity:1;transform:none"><header class="elements__Header-sc-1fad1na-0 fjUYIT"><nav class="elements__Nav-sc-1fad1na-2 ffjqnA"><div class="elements__Wrapper-sc-1fad1na-3 hrQEdM"><a class="elements__LogoWrapper-sc-1fad1na-5 iVCfuj" href="/"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjMiIGhlaWdodD0iMjMiIHZpZXdCb3g9IjAgMCAyMyAyMyIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMS41IDExLjYxNjZWMjIuNzg3QzExLjY5NDUgMjIuNzg3IDExLjgyMjMgMjIuNzQ0OCAxMS45OTY5IDIyLjY0NTFMMjAuOTQxNCAxNy41MzRDMjEuMjk0NSAxNy4zMzE2IDIxLjQzODUgMTcuMDE4MiAyMS40Mzg1IDE2LjYxMTFWNi4yNDY5MUMyMS40Mzg1IDYuMDQyNzEgMjEuMzk1NSA1LjkyMDU1IDIxLjI5NjMgNS43NUwxMS43ODYxIDExLjEyMzVDMTEuNjA5MiAxMS4yMjQ2IDExLjUgMTEuNDEyOCAxMS41IDExLjYxNjZaTTE2LjQ2OTEgMTguMDMwOUMxNi40NjkxIDE4LjMxNDggMTYuMzYyNyAxOC40NTY4IDE2LjExNDIgMTguNTk4OEwxMy4xMzI3IDIwLjMwMjVDMTIuOTE5OCAyMC40NDQ0IDEyLjYzNTggMjAuMzczNSAxMi42MzU4IDIwLjA4OTVWMTIuNDkzOEMxMi42MzU4IDEyLjI5MDYgMTIuODE0NiAxMi4wMjczIDEyLjk5MDcgMTEuOTI1OUwxOS44MDU2IDguMDIxNjFDMTkuOTk0OSA3LjkxMjY3IDIwLjE2MDUgOC4wODcxNSAyMC4xNjA1IDguMzA1NTZWMTIuMzUxOUMyMC4xNjA1IDEyLjU2MTYgMjAuMDYxNiAxMi43NTAxIDE5Ljg3NjUgMTIuODQ4OEwxNi44MjQxIDE0LjQ4MTVDMTYuNjM5IDE0LjU4MDIgMTYuNDY5MSAxNC43Njg2IDE2LjQ2OTEgMTQuOTc4NFYxOC4wMzA5WiIgZmlsbD0iIzk5OTk5OSIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEuNTYxNTIgMTYuNjExVjYuMjQ2ODRDMS41NjE1MiA1LjgzOTI1IDEuNzc1NTQgNS40NTUyNCAyLjEyOTQyIDUuMjUzMDFMMTAuNzg5OSAwLjM1NDg2NEMxMC45NzY1IDAuMjU1OTgxIDExLjI4NjggMC4yMTI4OTEgMTEuNDk5OCAwLjIxMjg5MUMxMS43MTI4IDAuMjEyODkxIDEyLjA0MTMgMC4yNjU2MzIgMTIuMjA5NyAwLjM1NDg2NkwyMC43OTkyIDUuMjUzMDFDMjAuOTY5MSA1LjM1MzQzIDIxLjIgNS41ODQ3MyAyMS4yOTYxIDUuNzQ5OTNMMTEuNzgzNyAxMS4xNDVDMTEuNjA2OCAxMS4yNDYxIDExLjQ5OTggMTEuNDM4MSAxMS40OTk4IDExLjY0MTlWMjIuNzg3QzExLjMwNTMgMjIuNzg3IDExLjEwNjUgMjIuNzQ0NyAxMC45MzE5IDIyLjY0NUwyLjIwMDQxIDE3LjYwNDlDMS44NDY1MiAxNy40MDI2IDEuNTYxNTIgMTcuMDE4NiAxLjU2MTUyIDE2LjYxMVpNMi44MzkzIDguMzA1NDhWMTIuMzUxOEMyLjgzOTMgMTIuNjM1NyAyLjkxMDI5IDEyLjc3NzcgMy4xOTQyNCAxMi45MTk3TDYuMTc1NzIgMTQuNjIzNEM2LjQ1OTY3IDE0Ljc2NTQgNi41MzA2NiAxNC45NzgzIDYuNTMwNjYgMTUuMTkxM1YxOC4wMzA4QzYuNTMwNjYgMTguMzE0NyA2LjYwMTY1IDE4LjQ1NjcgNi44ODU2IDE4LjU5ODdMOS44NjcwOCAyMC4zMDI0QzEwLjE1MSAyMC40NDQ0IDEwLjM2NCAyMC4zNzM0IDEwLjM2NCAyMC4wODk0VjEyLjQ5MzhDMTAuMzY0IDEyLjI4MDggMTAuMjkzIDEyLjA2NzggMTAuMDA5MSAxMS45MjU5TDMuMzM2MjEgOC4wOTI1MkMzLjEyMzI1IDcuOTUwNTUgMi44MzkzIDguMDIxNTMgMi44MzkzIDguMzA1NDhaTTE0LjQ4MTMgMy40NzgzMkwxMS44NTQ3IDQuOTY5MDZDMTEuNjQxOCA1LjExMTA0IDExLjM1NzggNS4xMTEwNCAxMS4xNDQ5IDQuOTY5MDZMOC41MTgzMSAzLjQ3ODMyQzguMzQ1NDIgMy4zODA2IDguMTIzNTkgMy4zODExIDcuOTUwNDEgMy40NzgzMkw0LjY4NDk4IDUuMzI0QzQuNDAxMDMgNS40NjU5OCA0LjQwMTAzIDUuNzQ5OTMgNC42ODQ5OCA1Ljg5MTlMMTEuMjE1OCA5LjY1NDI1QzExLjM5MDYgOS43NTQzMSAxMS42MDkgOS43NTQzMSAxMS43ODM3IDkuNjU0MjVMMTguMzE0NiA1Ljg5MTlDMTguNTI3NiA1Ljc0OTkzIDE4LjU5ODYgNS40NjU5OCAxOC4zMTQ2IDUuMzI0TDE1LjA0OTIgMy40NzgzMkMxNC44NzYgMy4zODExIDE0LjY1NDIgMy4zODA2IDE0LjQ4MTMgMy40NzgzMloiIGZpbGw9IiNGMkYyRjIiLz4KPC9zdmc+Cg==" alt="CodeSandbox Logo" class="elements__LogoImage-sc-1fad1na-6 liJZto"/>CodeSandbox</a><ul class="elements__List-sc-1fad1na-7 kGLnEc"><li><button type="button">Features<svg width="6" height="4" fill="none" viewBox="0 0 6 4" class="Navigation___StyledSvg-h33bys-0 dRznav"><path fill="#999" d="M.471 0L0 .471 2.828 3.3 5.657.47 5.185 0 2.828 2.357.471 0z"></path></svg></button></li><li><button type="button">Explore<svg width="6" height="4" fill="none" viewBox="0 0 6 4" class="Navigation___StyledSvg-h33bys-0 dRznav"><path fill="#999" d="M.471 0L0 .471 2.828 3.3 5.657.47 5.185 0 2.828 2.357.471 0z"></path></svg></button></li><li><button type="button">Resources<svg width="6" height="4" fill="none" viewBox="0 0 6 4" class="Navigation___StyledSvg-h33bys-0 dRznav"><path fill="#999" d="M.471 0L0 .471 2.828 3.3 5.657.47 5.185 0 2.828 2.357.471 0z"></path></svg></button></li><li><button type="button">Support<svg width="6" height="4" fill="none" viewBox="0 0 6 4" class="Navigation___StyledSvg-h33bys-0 dRznav"><path fill="#999" d="M.471 0L0 .471 2.828 3.3 5.657.47 5.185 0 2.828 2.357.471 0z"></path></svg></button></li><li><a href="/pricing">Pricing</a></li></ul><ul class="elements__List-sc-1fad1na-7 kGLnEc"><li class="tablet-remove"><a href="https://codesandbox.io/signin">Sign In</a></li><li class="elements__LogIn-sc-1fad1na-8 bVAwCL"><a class="Button__Link-yto3pm-1 kyilLh button" href="/s">Create Sandbox</a></li></ul></div></nav><nav class="elements__MobileNav-sc-1fad1na-9 cKmXFd"><a class="elements__LogoWrapper-sc-1fad1na-5 iVCfuj" href="/"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjMiIGhlaWdodD0iMjMiIHZpZXdCb3g9IjAgMCAyMyAyMyIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMS41IDExLjYxNjZWMjIuNzg3QzExLjY5NDUgMjIuNzg3IDExLjgyMjMgMjIuNzQ0OCAxMS45OTY5IDIyLjY0NTFMMjAuOTQxNCAxNy41MzRDMjEuMjk0NSAxNy4zMzE2IDIxLjQzODUgMTcuMDE4MiAyMS40Mzg1IDE2LjYxMTFWNi4yNDY5MUMyMS40Mzg1IDYuMDQyNzEgMjEuMzk1NSA1LjkyMDU1IDIxLjI5NjMgNS43NUwxMS43ODYxIDExLjEyMzVDMTEuNjA5MiAxMS4yMjQ2IDExLjUgMTEuNDEyOCAxMS41IDExLjYxNjZaTTE2LjQ2OTEgMTguMDMwOUMxNi40NjkxIDE4LjMxNDggMTYuMzYyNyAxOC40NTY4IDE2LjExNDIgMTguNTk4OEwxMy4xMzI3IDIwLjMwMjVDMTIuOTE5OCAyMC40NDQ0IDEyLjYzNTggMjAuMzczNSAxMi42MzU4IDIwLjA4OTVWMTIuNDkzOEMxMi42MzU4IDEyLjI5MDYgMTIuODE0NiAxMi4wMjczIDEyLjk5MDcgMTEuOTI1OUwxOS44MDU2IDguMDIxNjFDMTkuOTk0OSA3LjkxMjY3IDIwLjE2MDUgOC4wODcxNSAyMC4xNjA1IDguMzA1NTZWMTIuMzUxOUMyMC4xNjA1IDEyLjU2MTYgMjAuMDYxNiAxMi43NTAxIDE5Ljg3NjUgMTIuODQ4OEwxNi44MjQxIDE0LjQ4MTVDMTYuNjM5IDE0LjU4MDIgMTYuNDY5MSAxNC43Njg2IDE2LjQ2OTEgMTQuOTc4NFYxOC4wMzA5WiIgZmlsbD0iIzk5OTk5OSIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEuNTYxNTIgMTYuNjExVjYuMjQ2ODRDMS41NjE1MiA1LjgzOTI1IDEuNzc1NTQgNS40NTUyNCAyLjEyOTQyIDUuMjUzMDFMMTAuNzg5OSAwLjM1NDg2NEMxMC45NzY1IDAuMjU1OTgxIDExLjI4NjggMC4yMTI4OTEgMTEuNDk5OCAwLjIxMjg5MUMxMS43MTI4IDAuMjEyODkxIDEyLjA0MTMgMC4yNjU2MzIgMTIuMjA5NyAwLjM1NDg2NkwyMC43OTkyIDUuMjUzMDFDMjAuOTY5MSA1LjM1MzQzIDIxLjIgNS41ODQ3MyAyMS4yOTYxIDUuNzQ5OTNMMTEuNzgzNyAxMS4xNDVDMTEuNjA2OCAxMS4yNDYxIDExLjQ5OTggMTEuNDM4MSAxMS40OTk4IDExLjY0MTlWMjIuNzg3QzExLjMwNTMgMjIuNzg3IDExLjEwNjUgMjIuNzQ0NyAxMC45MzE5IDIyLjY0NUwyLjIwMDQxIDE3LjYwNDlDMS44NDY1MiAxNy40MDI2IDEuNTYxNTIgMTcuMDE4NiAxLjU2MTUyIDE2LjYxMVpNMi44MzkzIDguMzA1NDhWMTIuMzUxOEMyLjgzOTMgMTIuNjM1NyAyLjkxMDI5IDEyLjc3NzcgMy4xOTQyNCAxMi45MTk3TDYuMTc1NzIgMTQuNjIzNEM2LjQ1OTY3IDE0Ljc2NTQgNi41MzA2NiAxNC45NzgzIDYuNTMwNjYgMTUuMTkxM1YxOC4wMzA4QzYuNTMwNjYgMTguMzE0NyA2LjYwMTY1IDE4LjQ1NjcgNi44ODU2IDE4LjU5ODdMOS44NjcwOCAyMC4zMDI0QzEwLjE1MSAyMC40NDQ0IDEwLjM2NCAyMC4zNzM0IDEwLjM2NCAyMC4wODk0VjEyLjQ5MzhDMTAuMzY0IDEyLjI4MDggMTAuMjkzIDEyLjA2NzggMTAuMDA5MSAxMS45MjU5TDMuMzM2MjEgOC4wOTI1MkMzLjEyMzI1IDcuOTUwNTUgMi44MzkzIDguMDIxNTMgMi44MzkzIDguMzA1NDhaTTE0LjQ4MTMgMy40NzgzMkwxMS44NTQ3IDQuOTY5MDZDMTEuNjQxOCA1LjExMTA0IDExLjM1NzggNS4xMTEwNCAxMS4xNDQ5IDQuOTY5MDZMOC41MTgzMSAzLjQ3ODMyQzguMzQ1NDIgMy4zODA2IDguMTIzNTkgMy4zODExIDcuOTUwNDEgMy40NzgzMkw0LjY4NDk4IDUuMzI0QzQuNDAxMDMgNS40NjU5OCA0LjQwMTAzIDUuNzQ5OTMgNC42ODQ5OCA1Ljg5MTlMMTEuMjE1OCA5LjY1NDI1QzExLjM5MDYgOS43NTQzMSAxMS42MDkgOS43NTQzMSAxMS43ODM3IDkuNjU0MjVMMTguMzE0NiA1Ljg5MTlDMTguNTI3NiA1Ljc0OTkzIDE4LjU5ODYgNS40NjU5OCAxOC4zMTQ2IDUuMzI0TDE1LjA0OTIgMy40NzgzMkMxNC44NzYgMy4zODExIDE0LjY1NDIgMy4zODA2IDE0LjQ4MTMgMy40NzgzMloiIGZpbGw9IiNGMkYyRjIiLz4KPC9zdmc+Cg==" alt="CodeSandbox Logo" class="elements__LogoImage-sc-1fad1na-6 liJZto"/>CodeSandbox</a><div><a href="https://codesandbox.io/signin">Sign In</a><svg width="19" height="16" viewBox="0 0 19 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M19 2.14193H0V0.996094H19V2.14193ZM19 8.57552H0V7.42969H19V8.57552ZM0 15.0013H19V13.8555H0V15.0013Z" fill="white"></path></svg></div></nav></header></div></div><main style="max-width:80%;width:1200px;margin:auto" id="main" aria-label="main content"><div style="overflow-x:auto" class="PostElements__Container-sc-1nhtqd7-0 gATgEi"><div class="sc-bdVaJa hUWNdk"><div class="sc-bwzfXH gNoZef" width="800"><div class="sc-htpNat dKBugp"><h2 class="PostElements__Title-sc-1nhtqd7-1 ktnsV">How we make npm packages work in the browser</h2><aside class="_postelements__MetaData-sc-1otmru8-2 dGELJG"><div style="flex:1"><div class="_postelements__AuthorContainer-sc-1otmru8-3 iqVNPM"><img alt="Ives van Hoorne" src="https://avatars0.githubusercontent.com/u/587016?s=460&amp;v=4" class="PostElements__AuthorImage-sc-1nhtqd7-3 cEWHQa"/><h4 class="PostElements__Author-sc-1nhtqd7-4 chCInC">Ives van Hoorne</h4></div></div><span class="PostElements__PostDate-sc-1nhtqd7-2 gJVXgH">Oct 06, 2017</span></aside><img alt="How we make npm packages work in the browser" src="/static/banner-349d1f8eed7441b2a4f8902528c07633.png" class="_postelements__Image-sc-1otmru8-1 jjtOWa"/><div class="_postelements__PostContainer-sc-1otmru8-0 bwnAMd"><p>I always left <a href="https://npmjs.com">npm</a> dependency support out of scope during
initial development of <a href="https://codesandbox.io">CodeSandbox</a>. I thought it would
be impossible to install an arbitrary, random amount of packages in the browser,
even thinking about it caused my brain to block.</p>
<p>Nowadays npm support is one of the most defining features of CodeSandbox, so
somehow we succeeded in making it work. It took a lot of iterations to make it
work in any scenario, we did multiple rewrites and even now we can still improve
the logic. I'll explain how npm support started, what we have now and what we
still can do to improve it.</p>
<section>
<h2 id="first-version"><a href="#first-version" aria-label="first version permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>'First' Version</h2>
<p>I really didn't know how to approach this, so I started with a very simple
version of npm support:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 740px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/4bd1c2cd928c0a0a7d3ed93674922b7c/e106a/0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 45.4280722189866%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABH0lEQVQoz2NQ1rUwsLBRt7CX1jUWVdWDIzE1fUElbRVj6/r2ntbeiUDU0jOhuXtCU1d/Y2dfa8/EkpomBl0LZ1N7J30bByVjSzk9c2kdU2ltEyApq2cmoqpv7Rnw8vnzb1++vHn18tvXr//B4N+/f0Dy2YuXDOrGdlbWHoa2rrpmdhomtkoGlnK6ZrI6pkBSXM3AzNlr/4EDR44cvXTp8stXL9++e//z58/fv38DNd97+IhBUc/czMRO38ZF08xWzdBK3dBK1cBSXs9c0cBSAshx93/0+PHr169fvXr1FdXmh4+fMMjqmklpm0hqGklqGQORFITUNpHRNRNW0bXxCvz27RtQ6d+/f/+BAYpmkA+xIVmIZk+oZogGdJuHpmYA/0gSLC+sM9UAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="The absolute first version, importing styled-components and React (25 Nov 2016)"
        title="The absolute first version, importing styled-components and React (25 Nov 2016)"
        src="/static/4bd1c2cd928c0a0a7d3ed93674922b7c/bcf2d/0.png"
        srcset="/static/4bd1c2cd928c0a0a7d3ed93674922b7c/d5c4a/0.png 185w,
/static/4bd1c2cd928c0a0a7d3ed93674922b7c/04e89/0.png 370w,
/static/4bd1c2cd928c0a0a7d3ed93674922b7c/bcf2d/0.png 740w,
/static/4bd1c2cd928c0a0a7d3ed93674922b7c/dbb75/0.png 1110w,
/static/4bd1c2cd928c0a0a7d3ed93674922b7c/a808b/0.png 1480w,
/static/4bd1c2cd928c0a0a7d3ed93674922b7c/e106a/0.png 1717w"
        sizes="(max-width: 740px) 100vw, 740px"
        loading="lazy"
      />
  </a>
    </span></p>
<p>This version of npm support was very simple. It wasn't even really npm support,
I just installed the dependencies locally and stubbed every dependency call with
an already installed dependency. This, of course, is absolutely not scalable to
400,000 packages with different versions.</p>
<p>Even though this version was not very usable, it was encouraging to see that I
was able to at least make two dependencies work in a sandbox environment.</p>
</section>
<section>
<h2 id="webpack-version"><a href="#webpack-version" aria-label="webpack version permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>webpack Version</h2>
<p>I was quite satisfied with the first version, and I thought it would be
sufficient for an <a href="https://en.wikipedia.org/wiki/Minimum_viable_product">MVP</a>
(the first release of CodeSandbox). I didn't think it would be even possible to
install any dependency without performing magic. That was until I stumbled upon
<a href="https://github.com/voronianski/esnextbin">https://esnextb.in</a>. They already
supported any dependency from npm, you could just define them in <code class="language-text">package.json</code>
and it magically worked!</p>
<p>This was a big learning moment for me. I never dared to give proper npm support
a thought, because I thought 'it would be impossible'. Only after seeing living
proof of its 'possibleness' I started putting more thought into it. I should've
explored the possibilities first before dismissing the idea.</p>
<p>So! I started thinking on how to approach this. And boy did I overcomplicate it.
My first version didn't fit in my head, so I had to draw a diagram:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 696px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/d61fc7f3ba43b918c874cacbe0476c81/a82ee/1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 158.76436781609195%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAgCAIAAACdAM/hAAAACXBIWXMAAAsSAAALEgHS3X78AAACNElEQVQ4y5XV2VJiUQwFUP//A3mRKkvFAgQZBNpmtBdn24d7aWglD1Rukp05h7vJZPLx8fHrHyKcTqej0eiadj6f3+E+27TZbNbrtV8Wn9eJwQXwcrmUjph+D4fDNbAAF8ACLhaL90L/iXwZvNvt1DMej6lvBq9Wq2UhLm5IO6Zy1mcFv729VeFlsDjU2+1WtpHu93tCYQmr010hqhZYVwaDwWw2UyQ+QwL2yfp3oVkh7potPIJJTYV0VEi2YM/Pzw8PD6+vr+lcv99XiE+NaIEXhVROUfOkIKnVJhcGzbX5ikwBT1f7jMkaRoJJ/xIjBpI9ghd/yXddDzQpFL8BY94bdOx27XCyrW1fF8IoRwxly/98VBnGcDh8fHzkPl0VsNr5fHl5eXp60tE6+RNYZC29v7/XW2BCcQ6FsjZ1FjE+B0sJwFSz3nw1B8Pj2ZGd1jNSfLyq0FQVAjAvlPnLn3cxskuthjESDc/LtFAkqQIYA6MvGF38AsuT2g7wnVya244Aer1eJHlqWuBMMilln+tt0ArrBMCSdiZ3GhULogxWe/F8qZyEnYxSvLwILT9tq2HSTsMwWdt8ip+FxVDpQm7+1DA67nPeqZNp5ZNIJk8e+xNYSd1u13hkRaHIYSEeSWyYhnFxdcOygCz4lhh81ib4es/n4CSTtjVTre9OzvP71zPV5r8G5bDlJe3zZ+giOLvd6XTcWU6FF5IfgbOteTc4ytrk2r8H/4SOh5GXaXUjgWjnHwfqP64BNPSoAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="The first idea, probably wrong even"
        title="The first idea, probably wrong even"
        src="/static/d61fc7f3ba43b918c874cacbe0476c81/a82ee/1.png"
        srcset="/static/d61fc7f3ba43b918c874cacbe0476c81/d5c4a/1.png 185w,
/static/d61fc7f3ba43b918c874cacbe0476c81/04e89/1.png 370w,
/static/d61fc7f3ba43b918c874cacbe0476c81/a82ee/1.png 696w"
        sizes="(max-width: 696px) 100vw, 696px"
        loading="lazy"
      />
  </a>
    </span></p>
<p>There was one advantage of this overcomplicated approach: the actual
implementation was much easier than expected!</p>
<p>I learned that <a href="https://github.com/webpack/webpack"><code class="language-text">webpack</code></a>'s
<a href="https://webpack.js.org/plugins/dll-plugin">DllPlugin</a> was able to bundle
dependencies and spit out a JS bundle with a manifest. This manifest looked like
this:</p>
<div class="gatsby-highlight">
      <pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"dll_bundle"</span><span class="token punctuation">,</span>
  <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"./node_modules/fbjs/lib/emptyFunction.js"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"./node_modules/fbjs/lib/invariant.js"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"./node_modules/fbjs/lib/warning.js"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">"./node_modules/react"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">"./node_modules/fbjs/lib/emptyObject.js"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">"./node_modules/object-assign/index.js"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">"./node_modules/prop-types/checkPropTypes.js"</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token property">"./node_modules/prop-types/lib/ReactPropTypesSecret.js"</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
    <span class="token property">"./node_modules/react/cjs/react.development.js"</span><span class="token operator">:</span> <span class="token number">8</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>Every path is mapped to a module id. If I would require
<a href="https://github.com/facebook/react">React</a> I would only have to call
<code class="language-text">dll_bundle(3)</code> and I would get React! This was perfect for our use case, so I
started typing away and came up with this actual system:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 740px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/053e799d3b3670a2cbf6f414d6583b15/4dacb/2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 38.74680306905371%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAA3klEQVQY04WQyxKDMAhF+f/fc+lKnfqKJrY+o1V7Jsxk3PUuCBDgXpBhGMZx/ASc5zlNE8474DiO67rWdaVg33d+Cbdt03qs8FRVVZYlU/BfAVmWGWPoNwFd1/V9T7Vzrq5r/DRNSYq11gXgMJ4PfAYRwum9ZyL+siw+gBG0FUXRtq18A1CIRZj6GgLViYT7vmOB7gKTxFSEhljdmSuwFM06EQs/5CiSSPKUEJPUcREUolyT8zyzQtM0DJUn1VOChjTQyQlZEn561CZJkuf5H2YWg5ODQ6jjOAEZ7oryHxEpyuwFRf0FAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="The source of the service can be found here: https://github.com/CompuIves/codesandbox-bundler. This service also contains code to publish any sandbox to npm (really cool), we scrapped this feature later on."
        title="The source of the service can be found here: https://github.com/CompuIves/codesandbox-bundler. This service also contains code to publish any sandbox to npm (really cool), we scrapped this feature later on."
        src="/static/053e799d3b3670a2cbf6f414d6583b15/bcf2d/2.png"
        srcset="/static/053e799d3b3670a2cbf6f414d6583b15/d5c4a/2.png 185w,
/static/053e799d3b3670a2cbf6f414d6583b15/04e89/2.png 370w,
/static/053e799d3b3670a2cbf6f414d6583b15/bcf2d/2.png 740w,
/static/053e799d3b3670a2cbf6f414d6583b15/4dacb/2.png 782w"
        sizes="(max-width: 740px) 100vw, 740px"
        loading="lazy"
      />
  </a>
    </span></p>
<p>For every request to the packager I would create a new directory in
<code class="language-text">/tmp/:hash</code>, would run <code class="language-text">yarn add ${dependencyList}</code> and let <code class="language-text">webpack</code> bundle
afterwards. I'd save the new bundle on
<a href="https://cloud.google.com/sdk/gcloud">gcloud</a> as a way of caching. Much simpler
than the diagram, mostly because I replaced installing dependencies with
<a href="https://yarnpkg.com">yarn</a> and bundling with <code class="language-text">webpack</code>.</p>
<p>When you load a sandbox, we would first make sure that we'd have the manifest
and the bundle before evaluation. During evaluation we would call
<code class="language-text">dll_bundle(:id)</code> for every dependency. This worked very well, and I got my
first version with proper npm dependency live!</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 740px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/30534439f0d380e2887c555c96c12b55/093af/3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 57.44125326370757%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAACD0lEQVQoz2Pwzq4NLu31LugydvJR09RS09VX1dRR0dBW1dRW1dIBimgam2m6eam6eCAjFRcPLVdPBjVVZW1dbTVNNXUNbRNDXX19HXU9bVUdLSV1dXlVNXExCYeYhKJ7b1Iv3k+5/BCCUi8/TLj0oOLGEwYVLR0tAyMNfUMtPSMLCxMjE30dI31NfV01HR1VbW0RKen0rOz//////fv3PwZgUFBR09DRU9PWBZI6hsYySsrS8opAJKOgJK+sJigqnpqRCVT39dPXH5++/3j/9ce7Lz8+fv/x9efff/9AmtV19YGa1bR0dPWMVNU1FFVUldTU5RRV5JRU+IVEs/LzXt182eXSOi1xRl/Jgv7WdRMSZyxKnvXt4zewZh09IFJQVddU0TAyMNDU0QQKyioqKyirCgiJZRfmv7jyos6opnfF6ckzlk7fda61e/cC/4nfPn5H0SyroKQPDGF1DQU1dSUNDTVtLVFJqbziogcX72eox2Xn9WR3z03tWxQVXVPlVPzp7SeEZkU1DSk5BR1tHT1DQyAb6Gag4/mFxbJzc5++eBNb0dPcPm3KohWT5i/tm71w7vRF3z5/QdKsqi6vAIwgTQU1NVklZXCAqQqIiKWmZQAD7ObPv1//gUL4H1pow21WVVZVVlSWAgc1WLMKUHMKWDMwqv79+/cXCaBoBvpZGqYNplkVrvk3UDNGPAMAJY0NST0d6YYAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Whoop! We got material-ui and react running dynamically! (24 Dec 2016)"
        title="Whoop! We got material-ui and react running dynamically! (24 Dec 2016)"
        src="/static/30534439f0d380e2887c555c96c12b55/bcf2d/3.png"
        srcset="/static/30534439f0d380e2887c555c96c12b55/d5c4a/3.png 185w,
/static/30534439f0d380e2887c555c96c12b55/04e89/3.png 370w,
/static/30534439f0d380e2887c555c96c12b55/bcf2d/3.png 740w,
/static/30534439f0d380e2887c555c96c12b55/dbb75/3.png 1110w,
/static/30534439f0d380e2887c555c96c12b55/a808b/3.png 1480w,
/static/30534439f0d380e2887c555c96c12b55/093af/3.png 1915w"
        sizes="(max-width: 740px) 100vw, 740px"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Now there was still a big limitation with this system. It didn't support files
that were not in the dependency graph of <code class="language-text">webpack</code>. This means that for example
<code class="language-text">require(&#39;react-icons/lib/fa/fa-beer&#39;)</code> wouldn't work, because it was never
required by the entry point of the dependency in the first place.</p>
<p>I did release CodeSandbox with this version though, and got in contact with the
author of <a href="https://github.com/cerebral/webpackbin">WebpackBin</a>
<a href="https://twitter.com/christianalfoni">Christian Alfoni</a>. We used a very similar
system to support npm dependencies and we were having the same limitations. So
we decided to combine forces and build the <strong>ultimate</strong> packager!</p>
</section>
<section>
<h2 id="webpack-with-entries"><a href="#webpack-with-entries" aria-label="webpack with entries permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>webpack with entries</h2>
<p>The "ultimate" packager retained the same functionality as our previous
packager, except <a href="https://twitter.com/christianalfoni">Christian</a> created an
algorithm that would add files to the bundle depending on their importance. This
means that we manually added entry points, to make sure that <code class="language-text">webpack</code> would
bundle those files too. After a lot of tweaking of this system we got it working
for any(?) combination. So you were able to require
<a href="https://github.com/react-icons/react-icons"><code class="language-text">react-icons</code></a>, and CSS files as
well 🎉.</p>
<p><blockquote class="twitter-tweet" data-dnt="true"><p lang="en" dir="ltr">We did it! <a href="https://twitter.com/christianalfoni">@christianalfoni</a> and I combined forces and created a common NPM bundler for WebpackBin and CodeSandbox! 1/2 <a href="https://t.co/6X3hxamLyN">pic.twitter.com/6X3hxamLyN</a></p>&mdash; Ives van Hoorne (@CompuIves) <a href="https://twitter.com/CompuIves/status/855865667739951106">April 22, 2017</a></blockquote></p>
<p>The new system also got an architectural upgrade: we have one
<a href="https://en.wikipedia.org/wiki/Dynamic-link_library">DLL</a> service that serves as
load balancer and cache. Then we have multiple packagers that do the bundling,
these packagers can be dynamically added.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 740px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/38cb6c9117299fff7cebaa7403846bf9/5d4cf/4.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.124721603563465%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABRElEQVQoz21Ri3aCMAz1/79w0015KIJNSV8UaBF3EeGwzXtCSW9y0zTduSestd7786X4+Dx8fR/TLE/SNM2yU5JezpckAZFnWS6ImqZxC3ZPpTPGwCmralLk5+JaQvx9PO33h4nMMtTFSkT2ia3YSlkDWmulNCssGmaMha0MgCzCxzzrX+KlGP5mw9g/WHKWk+F1bRdCaBrftm2MEZeHMzHeIzQzXTflOET6fmYgnMRgH48Ha3tTahzHvu9nptZWaAUHzDDE4T7ialaW4/0OZhHHiGrEuiL2HaR9iAFHE6tSyHYqhnhAhIiFkCj9EqP12qjK0JUFrDKytoqdJsfTVkvZKOWMU+T5pkVhqITjNP8a2HZCqI3+lbFszdw23nKd0zq8nfsHBDCSECLV+oom44DdqtzijRjgxgjHBYtLLWhu+x1+AJrdb+Mh9IJaAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Packager teamwork!"
        title="Packager teamwork!"
        src="/static/38cb6c9117299fff7cebaa7403846bf9/bcf2d/4.png"
        srcset="/static/38cb6c9117299fff7cebaa7403846bf9/d5c4a/4.png 185w,
/static/38cb6c9117299fff7cebaa7403846bf9/04e89/4.png 370w,
/static/38cb6c9117299fff7cebaa7403846bf9/bcf2d/4.png 740w,
/static/38cb6c9117299fff7cebaa7403846bf9/5d4cf/4.png 898w"
        sizes="(max-width: 740px) 100vw, 740px"
        loading="lazy"
      />
  </a>
    </span></p>
<p>We wanted to make the packager service available for everyone. That's why we
built <a href="http://webpack-dll-prod.herokuapp.com/">a website</a> that would explain how
the service works and how you can make use of it. This turned out to be a great
success, we were even mentioned in the
<a href="https://blog.codepen.io/2017/08/11/using-resources-npm-codepen">CodePen blog</a>!</p>
<p>There were still some limitations and disadvantages to this 'ultimate' packager.
The costs grew exponentially as we became more popular, and we were caching by
package <em>combination</em>. Which means that we had to rebundle your whole package
combination if you added a dependency.</p>
</section>
<section>
<h2 id="going-serverless"><a href="#going-serverless" aria-label="going serverless permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Going Serverless</h2>
<p>I always wanted to try this cool technology called
'<a href="https://martinfowler.com/articles/serverless.html">serverless</a>'. With
serverless you can define a function that will execute on request, the function
will spin up, handle the request and then kill itself after some time. This
means that you have very high scalability: if you get 1000 simultaneous requests
you can just spin up 1000 servers instantly. It also means that you only pay for
the time the servers actually run.</p>
<p>Serverless sounds perfect for our service: it doesn't run fulltime and we need
high concurrency in case there are multiple requests at the same time. So I
started playing eagerly with an aptly named framework called
<a href="https://serverless.com">Serverless</a>.</p>
<p>Converting our service went smoothly (thanks Serverless!), I had a working
version within 2 days. I created three serverless functions:</p>
<ol>
<li>A metadata resolver: this service would resolve versions and peerDependencies
and request the packager function.</li>
<li>A packager: this service would do the actual installing &#x26; bundling of the
dependencies</li>
<li>An uglifier: responsible for asynchronously uglifying the resulting bundle.</li>
</ol>
<p>I ran the new service alongside the old service, and it worked really well! We
had a projected cost of $0.18 per month (compared to $100) and our response time
improved between 40% and 700%.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 678px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/d2ac091fa99d4ed6f8684ec0e1aa8b8c/6b427/5.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 90.7079646017699%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsSAAALEgHS3X78AAACMElEQVQ4y41U266TQBTlm4wvx/gZvnhiYnz0M0w8D57vMDE+nF/wmjT6VFMo19LCAAUKw62l3OGsQg+p1lRX2slmmLXXnrVnYAghLMsKojifz03T9Dxv08N13T8ChPhrmiZJsqqqjuMykizNZjOe50HWNF3XSQ8DiUzLMohhYQQIMXusVkswBUHwfZ9JkiSKIhrQOEnatm2apqqqpm7qum5PgPkx7rpueGQcx0FeGgRhGKJi6lPk2ngbjHEU+76HsmkPSEEDI9Z2PRgUpCwUzGNdGITYM7L0st255qn4gbxarhRFmU6nsixxHDeZTHxK8WJccQEMDBBFiecFuMVyHIwLw2if7dMeUL1ERp22bQdB4Liu7TgBDbCr9drCVuEzzBuq+KtzDIwpirKfagYbgZ5wyF3/juHV0AvkZaI4zvIcU368/86SvIRUe25R06dO8/SH9DMt9ojLsjz0OcsLPHyRksdveTs6xPUZG2KYl33l2YfrBVURF2XBJPGR/FXeXt0u7Ki8QFbo4vru5Qn5QfmbvH3yTrHj/yAHyyN5t0tH8tNb5Z/KL+5eqfSBDLcH8mdp++hGXl8kS9jzx+dIcSRnWbZL4V77i6Sv36+8pOjauiwrNKMoCvQfriIu0fC2I6Hx5tONERkg53nOjLfHMi1REHAdxgNEdDJn2fXaGfqPEYdfFuUk2R5PWJrucMdxt7BUJyZOG245fpAFASUMtLxqXBpalqkRHScPXwXLNO8BgFLw7m3CbfwAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="This felt sooooo good"
        title="This felt sooooo good"
        src="/static/d2ac091fa99d4ed6f8684ec0e1aa8b8c/6b427/5.png"
        srcset="/static/d2ac091fa99d4ed6f8684ec0e1aa8b8c/d5c4a/5.png 185w,
/static/d2ac091fa99d4ed6f8684ec0e1aa8b8c/04e89/5.png 370w,
/static/d2ac091fa99d4ed6f8684ec0e1aa8b8c/6b427/5.png 678w"
        sizes="(max-width: 678px) 100vw, 678px"
        loading="lazy"
      />
  </a>
    </span></p>
<p>After several days I started noticing a limitation though: a lambda function
only has 500MB of maximum disk space, this means that some combinations of
dependencies weren't able to install. This was a deal breaker and I had to get
back to the drawing board.</p>
<h4 id="serverless-revisited"><a href="#serverless-revisited" aria-label="serverless revisited permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Serverless Revisited</h4>
<p>A couple months went by and
<a href="/post/creating-a-parallel-offline-extensible-browser-based-bundler-for-codesandbox">I released a new bundler for CodeSandbox</a>.
This bundler is very powerful, and allows us to easily support more libraries
like <a href="https://github.com/vuejs/vue">Vue</a> and
<a href="https://github.com/preactjs/preact">Preact</a>. By supporting these libraries we
got some interesting requests. For example: if you want to use a
<a href="https://github.com/facebook/react">React</a> library in Preact, you'd need to
alias <code class="language-text">require(&#39;react&#39;)</code> to <code class="language-text">require(&#39;preact-compat&#39;)</code>. For Vue, you may want to
resolve <code class="language-text">@/components/App.vue</code> to your sandbox files. Our packager doesn't do
this for dependencies, but our bundler does.</p>
<p>That's when I started thinking that we could maybe let the browser bundler do
the actual packaging. If we would just send the relevant files to the browser
we'd let the bundler do the actual bundling of the dependencies. This should be
faster, because we're not evaluating the whole bundle, just parts of it.</p>
<p>There is a great advantage to this approach: we will be able to install and
cache dependencies independently. We can just merge the dependency files on the
client. This means that if you request a new dependency on top of your existing
dependencies, we'd only need to gather files for the new dependency! This will
solve the 500MB limit from <a href="https://aws.amazon.com/lambda">AWS Lambda</a>, since
we're only installing one dependency. We can also drop <code class="language-text">webpack</code> from the
packager, since the packager now has the sole responsibility of figuring out
which files are relevant and sending them.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 740px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/0fb2c3ba45c7a7925e1dbfc171108022/1589a/6.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 43.8871473354232%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAAAwUlEQVQoz4WR2w6EIAxE+f/PNJioeAUFV4XdE5u4idEwDwTaznRa1DeHfd8/J7Ztu6XUGyel5L231nZdN45j3/fOuXVd0ZIseCUfxzHPc4wxhIDKsiw0h8nz35kiiQKMSSmQOxVkYSJEBC2eUDAyDIPCCcbquq6qSmvNpW1bYww5Mdw0DaVEsI0oJ/GiKMqyVLc56YZ2OEFDgqhftunJHY/TNKGiZPTHmSHIkGJbpkMrv21AE2w/bjtPvv6ZVT3+8w+rbw54PRKAtwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="We parallelize the packaging of the dependencies"
        title="We parallelize the packaging of the dependencies"
        src="/static/0fb2c3ba45c7a7925e1dbfc171108022/bcf2d/6.png"
        srcset="/static/0fb2c3ba45c7a7925e1dbfc171108022/d5c4a/6.png 185w,
/static/0fb2c3ba45c7a7925e1dbfc171108022/04e89/6.png 370w,
/static/0fb2c3ba45c7a7925e1dbfc171108022/bcf2d/6.png 740w,
/static/0fb2c3ba45c7a7925e1dbfc171108022/dbb75/6.png 1110w,
/static/0fb2c3ba45c7a7925e1dbfc171108022/1589a/6.png 1276w"
        sizes="(max-width: 740px) 100vw, 740px"
        loading="lazy"
      />
  </a>
    </span></p>
<blockquote>
<p><em>Note: We could also drop the packager and request every file dynamically from
<a href="https://unpkg.com">unpkg.com</a>. This is probably even faster than my new
approach. I decided to still keep the packager (at least for the editor),
because I want to provide offline support. That's only possible if you have
all possible relevant files with you.</em></p>
</blockquote>
<h4 id="how-it-works-in-practice"><a href="#how-it-works-in-practice" aria-label="how it works in practice permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How it works in practice</h4>
<p>When we request a combination of dependencies, we first check if this
combination already is stored on <a href="https://aws.amazon.com/s3">S3</a>. If it's not on
S3 we request the combination from the API service; this service requests all
packagers independently for every dependency. As soon as we get the
<a href="https://developer.mozilla.org/nl/docs/Web/HTTP/Status/200">200 OK</a> back, we
request S3 again.</p>
<p>The packager installs the dependencies using yarn and finds all relevant files
by traversing the <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">AST</a> of
all files in the directory of the entry point. It searches for require
statements and adds them to the file list. This happens recursively, so we get a
dependency graph. An example output (of <code class="language-text">react@latest</code>) is this:</p>
<div class="gatsby-highlight">
      <pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"aliases"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"asap"</span><span class="token operator">:</span> <span class="token string">"asap/browser-asap.js"</span><span class="token punctuation">,</span>
    <span class="token property">"asap/asap"</span><span class="token operator">:</span> <span class="token string">"asap/browser-asap.js"</span><span class="token punctuation">,</span>
    <span class="token property">"asap/asap.js"</span><span class="token operator">:</span> <span class="token string">"asap/browser-asap.js"</span><span class="token punctuation">,</span>
    <span class="token property">"asap/raw"</span><span class="token operator">:</span> <span class="token string">"asap/browser-raw.js"</span><span class="token punctuation">,</span>
    <span class="token property">"asap/raw.js"</span><span class="token operator">:</span> <span class="token string">"asap/browser-raw.js"</span><span class="token punctuation">,</span>
    <span class="token property">"asap/test/domain.js"</span><span class="token operator">:</span> <span class="token string">"asap/test/browser-domain.js"</span><span class="token punctuation">,</span>
    <span class="token property">"core-js"</span><span class="token operator">:</span> <span class="token string">"core-js/index.js"</span><span class="token punctuation">,</span>
    <span class="token property">"encoding"</span><span class="token operator">:</span> <span class="token string">"encoding/lib/encoding.js"</span><span class="token punctuation">,</span>
    <span class="token property">"fbjs"</span><span class="token operator">:</span> <span class="token string">"fbjs/index.js"</span><span class="token punctuation">,</span>
    <span class="token property">"iconv-lite"</span><span class="token operator">:</span> <span class="token string">"iconv-lite/lib/index.js"</span><span class="token punctuation">,</span>
    <span class="token property">"iconv-lite/extend-node"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">"iconv-lite/streams"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">"is-stream"</span><span class="token operator">:</span> <span class="token string">"is-stream/index.js"</span><span class="token punctuation">,</span>
    <span class="token property">"isomorphic-fetch"</span><span class="token operator">:</span> <span class="token string">"isomorphic-fetch/fetch-npm-browserify.js"</span><span class="token punctuation">,</span>
    <span class="token property">"js-tokens"</span><span class="token operator">:</span> <span class="token string">"js-tokens/index.js"</span><span class="token punctuation">,</span>
    <span class="token property">"loose-envify"</span><span class="token operator">:</span> <span class="token string">"loose-envify/index.js"</span><span class="token punctuation">,</span>
    <span class="token property">"node-fetch"</span><span class="token operator">:</span> <span class="token string">"node-fetch/index.js"</span><span class="token punctuation">,</span>
    <span class="token property">"object-assign"</span><span class="token operator">:</span> <span class="token string">"object-assign/index.js"</span><span class="token punctuation">,</span>
    <span class="token property">"promise"</span><span class="token operator">:</span> <span class="token string">"promise/index.js"</span><span class="token punctuation">,</span>
    <span class="token property">"prop-types"</span><span class="token operator">:</span> <span class="token string">"prop-types/index.js"</span><span class="token punctuation">,</span>
    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"react/index.js"</span><span class="token punctuation">,</span>
    <span class="token property">"setimmediate"</span><span class="token operator">:</span> <span class="token string">"setimmediate/setImmediate.js"</span><span class="token punctuation">,</span>
    <span class="token property">"ua-parser-js"</span><span class="token operator">:</span> <span class="token string">"ua-parser-js/src/ua-parser.js"</span><span class="token punctuation">,</span>
    <span class="token property">"whatwg-fetch"</span><span class="token operator">:</span> <span class="token string">"whatwg-fetch/fetch.js"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"contents"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"fbjs/lib/emptyFunction.js"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"/* code */"</span><span class="token punctuation">,</span>
      <span class="token property">"requires"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"fbjs/lib/emptyObject.js"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"/* code */"</span><span class="token punctuation">,</span>
      <span class="token property">"requires"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"fbjs/lib/invariant.js"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"/* code */"</span><span class="token punctuation">,</span>
      <span class="token property">"requires"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"fbjs/lib/warning.js"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"/* code */"</span><span class="token punctuation">,</span>
      <span class="token property">"requires"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"./emptyFunction"</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"object-assign/index.js"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"/* code */"</span><span class="token punctuation">,</span>
      <span class="token property">"requires"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"prop-types/checkPropTypes.js"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"/* code */"</span><span class="token punctuation">,</span>
      <span class="token property">"requires"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">"fbjs/lib/invariant"</span><span class="token punctuation">,</span>
        <span class="token string">"fbjs/lib/warning"</span><span class="token punctuation">,</span>
        <span class="token string">"./lib/ReactPropTypesSecret"</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"prop-types/lib/ReactPropTypesSecret.js"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"/* code */"</span><span class="token punctuation">,</span>
      <span class="token property">"requires"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"react/index.js"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"/* code */"</span><span class="token punctuation">,</span>
      <span class="token property">"requires"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"./cjs/react.development.js"</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"react/package.json"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"/* code */"</span><span class="token punctuation">,</span>
      <span class="token property">"requires"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"react/cjs/react.development.js"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"/* code */"</span><span class="token punctuation">,</span>
      <span class="token property">"requires"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">"object-assign"</span><span class="token punctuation">,</span>
        <span class="token string">"fbjs/lib/warning"</span><span class="token punctuation">,</span>
        <span class="token string">"fbjs/lib/emptyObject"</span><span class="token punctuation">,</span>
        <span class="token string">"fbjs/lib/invariant"</span><span class="token punctuation">,</span>
        <span class="token string">"fbjs/lib/emptyFunction"</span><span class="token punctuation">,</span>
        <span class="token string">"prop-types/checkPropTypes"</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"dependency"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"react"</span><span class="token punctuation">,</span>
    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"16.0.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"dependencyDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"asap"</span><span class="token operator">:</span> <span class="token string">"2.0.6"</span><span class="token punctuation">,</span>
    <span class="token property">"core-js"</span><span class="token operator">:</span> <span class="token string">"1.2.7"</span><span class="token punctuation">,</span>
    <span class="token property">"encoding"</span><span class="token operator">:</span> <span class="token string">"0.1.12"</span><span class="token punctuation">,</span>
    <span class="token property">"fbjs"</span><span class="token operator">:</span> <span class="token string">"0.8.16"</span><span class="token punctuation">,</span>
    <span class="token property">"iconv-lite"</span><span class="token operator">:</span> <span class="token string">"0.4.19"</span><span class="token punctuation">,</span>
    <span class="token property">"is-stream"</span><span class="token operator">:</span> <span class="token string">"1.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"isomorphic-fetch"</span><span class="token operator">:</span> <span class="token string">"2.2.1"</span><span class="token punctuation">,</span>
    <span class="token property">"js-tokens"</span><span class="token operator">:</span> <span class="token string">"3.0.2"</span><span class="token punctuation">,</span>
    <span class="token property">"loose-envify"</span><span class="token operator">:</span> <span class="token string">"1.3.1"</span><span class="token punctuation">,</span>
    <span class="token property">"node-fetch"</span><span class="token operator">:</span> <span class="token string">"1.7.3"</span><span class="token punctuation">,</span>
    <span class="token property">"object-assign"</span><span class="token operator">:</span> <span class="token string">"4.1.1"</span><span class="token punctuation">,</span>
    <span class="token property">"promise"</span><span class="token operator">:</span> <span class="token string">"7.3.1"</span><span class="token punctuation">,</span>
    <span class="token property">"prop-types"</span><span class="token operator">:</span> <span class="token string">"15.6.0"</span><span class="token punctuation">,</span>
    <span class="token property">"setimmediate"</span><span class="token operator">:</span> <span class="token string">"1.0.5"</span><span class="token punctuation">,</span>
    <span class="token property">"ua-parser-js"</span><span class="token operator">:</span> <span class="token string">"0.7.14"</span><span class="token punctuation">,</span>
    <span class="token property">"whatwg-fetch"</span><span class="token operator">:</span> <span class="token string">"2.0.3"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
</section>
<section>
<h2 id="advantages"><a href="#advantages" aria-label="advantages permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Advantages</h2>
<h4 id="save-in-cost"><a href="#save-in-cost" aria-label="save in cost permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Save in cost</h4>
<p>I've deployed the new packager two days ago, we paid a whopping $0.02 for those
two days! And this was for building up the cache. This is a huge saving compared
to $100 a month.</p>
<h4 id="higher-performance"><a href="#higher-performance" aria-label="higher performance permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Higher performance</h4>
<p>You can now get a new combination of dependencies within 3 seconds, for any
combination. With the old system this sometimes would take a minute. If the
combination is cached you'll get it within 50ms on a fast connection. We cache
the dependencies using <a href="https://aws.amazon.com/cloudfront">Amazon Cloudfront</a>
all over the world. Our sandbox also runs faster, because we now only parse and
execute the relevant JS files for your sandbox.</p>
<h4 id="more-flexibility"><a href="#more-flexibility" aria-label="more flexibility permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>More flexibility</h4>
<p>Our bundler now handles the dependencies as if it were local files. This means
that our error stack traces are now much clearer, we can now include any file
from dependencies (like <code class="language-text">.scss</code>, <code class="language-text">.vue</code>, etc.) and we can easily support things
like aliases. It works just as if the dependencies are installed locally.</p>
</section>
<section>
<h2 id="release"><a href="#release" aria-label="release permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Release</h2>
<p>Two days ago I started using the new packager alongside the old packager, to
build up cache. It already cached 2,000 different combinations and 1400
different dependencies. I want to test the new version extensively before
actually moving over. You can try it today by enabling it in your preferences!</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 740px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b856e3f0d764038b08c772dd560b7421/0c1ff/7.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 53.7843268586738%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABmklEQVQoz3WSy2vbQBDGBY2tlbSGEr1t7Ur70suOgyM3cRwMOSQ4PfRQSErbQ2+lp/bcYw6BXPMn9xOGYNIEfgzDar75NDtrDW0yGNoHg+G7g4HjUjoaeZQSxwWuRz06whGSXY44JGRg2wBCyyZOPM5YLrJcpBlPMzZmXJrS1K0qayZkLjUXihUSkQs5KQQK0kn2/tDvxapqTk5X85NlrkxWSMTlan15dX223lTTI123ppnuU88X3cVlECeW7bhMKGEqyJBMcsGlRqPu7Bycri+OFl09m8MAXXQ9VaZqu/Or2x9+GPbOQpf4jJbwhBjx2QSCsp3tkmdUWQmlgyjpxVyZenaMIiY1kybX5X7pq2CcIIot4ngTlglRcM6TJI6ikBXFC6v/gVM/MyHO5vbnt79Pn/88XP+6v/n9ON9shVKmQVHzFqadhklqYZ3Hm+360/cPN3fd9svy49dqscKSdDN7ccn74LejZGw5Ho3TcRhFvu8HAcIhdlgokyuNDb8FCvwwgrNHeii6AJeO8LZwi7ZNMNHuqb0KhP8ALLVVVNKqbVAAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="7"
        title="7"
        src="/static/b856e3f0d764038b08c772dd560b7421/bcf2d/7.png"
        srcset="/static/b856e3f0d764038b08c772dd560b7421/d5c4a/7.png 185w,
/static/b856e3f0d764038b08c772dd560b7421/04e89/7.png 370w,
/static/b856e3f0d764038b08c772dd560b7421/bcf2d/7.png 740w,
/static/b856e3f0d764038b08c772dd560b7421/dbb75/7.png 1110w,
/static/b856e3f0d764038b08c772dd560b7421/a808b/7.png 1480w,
/static/b856e3f0d764038b08c772dd560b7421/0c1ff/7.png 1493w"
        sizes="(max-width: 740px) 100vw, 740px"
        loading="lazy"
      />
  </a>
    </span></p>
<blockquote>
<p><em>Also, if you're interested in the source, you can find it
<a href="https://github.com/codesandbox/dependency-packager">here</a>.</em></p>
</blockquote>
<h4 id="go-serverless"><a href="#go-serverless" aria-label="go serverless permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Go Serverless!</h4>
<p>I am very impressed by serverless, it makes server scalability and management
incredibly easy. The only thing that always held me back from serverless is the
very complicated setup, but the people at
<a href="https://serverless.com">serverless.com</a> made this child's play. I'm very
grateful for their work, I do think that serverless is the future for many
different application forms.</p>
</section>
<section>
<h2 id="future"><a href="#future" aria-label="future permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Future</h2>
<p>We can still improve the system in a lot of ways, I'm eager to explore
dynamically requesting requires in embeds and preserving offline. It's a hard
balance to keep, but it should be possible. We can also start caching
dependencies independently in the browser, depending on what the browser allows.
In that case you sometimes don't even need to download new dependencies when
visiting a new sandbox with different dependency combination. I'm also going to
explore dependency resolution more, there is a chance of conflicting versions
with the new system which I want to solve before going full on.</p>
<p>Nevertheless I'm very happy with the new version, onwards to working on new
things for CodeSandbox!</p>
<p><em>If you're interested in CodeSandbox, we're 90% open source! The most activity
is <a href="https://github.com/codesandbox/codesandbox-client">here</a>.</em></p>
</section></div></div></div></div></div></main><footer class="elements__FooterWrapper-sc-9c2o28-0 hHFJvc"><section class="elements__Nav-sc-9c2o28-1 kzxyPu"><ul><li><p class="Typography__P-xlq88a-1 hajUBy">Product</p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/ide">Online IDE</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/embeds">Embed</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/ci">CodeSandbox CI</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/team">Teams</a></p></li></ul><ul><li><p class="Typography__P-xlq88a-1 hajUBy">Explore</p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/explore">Featured Sandboxes</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/search">Search Sandboxes</a></p></li></ul><ul><li><p class="Typography__P-xlq88a-1 hajUBy">Use Cases</p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/prototyping">Prototyping</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/learning">Learning</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/hiring">Hiring</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/onboarding">Onboarding</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/collaboration">Collaboration</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/open-source">Open Source</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/devrel">DevRel</a></p></li></ul><ul><li><p class="Typography__P-xlq88a-1 hajUBy">About</p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/company">Company</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/blog">Blog</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/pricing">Pricing</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/jobs">Careers</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/legal">Legal</a></p></li></ul><ul><li><p class="Typography__P-xlq88a-1 hajUBy">Support</p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="/docs">Documentation</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="mailto:hello@codesandbox.io">Contact Support</a></p></li><li><p muted="" class="Typography__P-xlq88a-1 cWWqEe"><a href="https://status.codesandbox.io">Status</a></p></li></ul></section><ul class="elements__Social-sc-9c2o28-2 brInaT"><li><a title="Go to Github" href="https://github.com/codesandbox/codesandbox-client"><svg width="18" height="18" fill="none" viewBox="0 0 18 18"><path fill="#9d9d9d" fill-rule="evenodd" d="M4 0a4 4 0 00-4 4v10a4 4 0 004 4h10a4 4 0 004-4V4a4 4 0 00-4-4H4zm10.195 6.063a6.05 6.05 0 00-2.183-2.238A5.759 5.759 0 009 3a5.76 5.76 0 00-3.012.825 6.05 6.05 0 00-2.183 2.238A6.132 6.132 0 003 9.15c0 1.34.381 2.546 1.145 3.616.763 1.07 1.748 1.811 2.956 2.222.141.027.245.008.313-.056a.317.317 0 00.101-.24c0-.016 0-.16-.003-.432-.003-.273-.004-.51-.004-.713l-.18.032c-.115.021-.26.03-.434.028a3.22 3.22 0 01-.543-.056 1.2 1.2 0 01-.523-.24 1.016 1.016 0 01-.344-.493l-.078-.184a2.011 2.011 0 00-.246-.408.95.95 0 00-.34-.305l-.054-.04a.582.582 0 01-.172-.208c-.016-.037-.003-.068.039-.092a.496.496 0 01.226-.036l.157.024c.104.021.233.085.386.192.154.107.28.246.38.416a1.4 1.4 0 00.433.5c.169.116.34.173.511.173.172 0 .32-.013.446-.04.125-.027.242-.067.351-.12.047-.358.175-.633.383-.825a5.226 5.226 0 01-.8-.144 3.148 3.148 0 01-.735-.313 2.117 2.117 0 01-.629-.536 2.604 2.604 0 01-.41-.841 4.092 4.092 0 01-.16-1.201c0-.646.206-1.196.617-1.65-.193-.486-.175-1.03.055-1.634.15-.048.375-.012.672.108.296.12.514.224.652.309.138.085.249.157.332.216A5.42 5.42 0 019 5.971c.515 0 1.015.07 1.5.208l.297-.192c.203-.128.443-.246.718-.353.276-.106.488-.136.633-.088.235.604.256 1.148.063 1.634.411.454.617 1.004.617 1.65 0 .454-.053.855-.16 1.205-.107.35-.245.63-.414.84-.17.212-.38.39-.633.533a3.15 3.15 0 01-.734.313 5.224 5.224 0 01-.801.144c.27.24.406.62.406 1.137v1.69c0 .096.033.176.098.24s.168.083.309.056c1.208-.411 2.194-1.152 2.957-2.222C14.617 11.696 15 10.49 15 9.15a6.138 6.138 0 00-.805-3.087z" clip-rule="evenodd"></path></svg></a></li><li><a title="Go to Twitter" href="https://twitter.com/codesandbox"><svg width="18" height="18" fill="none" viewBox="0 0 18 18"><path fill="#9d9d9d" d="M0 4a4 4 0 014-4h10a4 4 0 014 4v10a4 4 0 01-4 4H4a4 4 0 01-4-4V4zm13.263 2.328c.451-.267.788-.684.947-1.173a4.33 4.33 0 01-1.368.514A2.17 2.17 0 0011.269 5c-1.189 0-2.154.949-2.154 2.12 0 .166.018.329.056.484A6.15 6.15 0 014.73 5.388a2.08 2.08 0 00-.292 1.066c0 .736.381 1.385.959 1.764-.342-.01-.677-.1-.976-.264v.027c0 1.027.743 1.884 1.729 2.079a2.22 2.22 0 01-.973.036 2.151 2.151 0 002.013 1.473 4.37 4.37 0 01-2.676.906c-.174 0-.346-.008-.514-.028a6.156 6.156 0 003.302.953c3.962 0 6.129-3.231 6.129-6.034a5.01 5.01 0 00-.006-.274 4.339 4.339 0 001.074-1.097c-.392.17-.809.283-1.236.333z"></path></svg></a></li><li><a title="Go to Spectrum" href="https://spectrum.chat/codesandbox"><svg width="18" height="18" fill="none" viewBox="0 0 18 18"><path fill="#9d9d9d" d="M0 4a4 4 0 014-4h10a4 4 0 014 4v10a4 4 0 01-4 4H4a4 4 0 01-4-4V4zm4 4c0 .394.106 1 .5 1h1C7.336 9 9 10.664 9 12.5v1c0 .394.106.5.5.5H13c.394 0 1-.106 1-.5v-1C14 8.04 9.96 4 5.5 4h-1c-.394 0-.5.606-.5 1v3z"></path></svg></a></li></ul><p muted="" class="Typography__P-xlq88a-1 Footer___StyledP-wcuxep-0 dIuYjC">Copyright © <!-- -->2019<!-- --> CodeSandbox BV</p></footer></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/post/how-we-make-npm-packages-work-in-the-browser";window.webpackCompilationHash="43a07f76784e304bf1a0";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-a8a2381ab2d52452ce71.js"],"component---src-templates-post-js":["/component---src-templates-post-js-85254caf75885945d366.js"],"component---src-templates-docs-js":["/component---src-templates-docs-js-d4a2394264b9c29540c1.js"],"component---src-templates-job-js":["/component---src-templates-job-js-6092dc02271a438ecb98.js"],"component---src-templates-feature-js":["/component---src-templates-feature-js-a4cc7cbf3b255953e4af.js"],"component---src-pages-index-js":["/component---src-pages-index-js-2b25e2b02171beef9620.js"],"component---src-pages-404-js":["/component---src-pages-404-js-554664ab4becd6922dbb.js"],"component---src-pages-blog-index-js":["/component---src-pages-blog-index-js-d5b316aefdb00b8f7f00.js"],"component---src-pages-company-index-js":["/component---src-pages-company-index-js-a439f6fb0d221b6a9d72.js"],"component---src-pages-embeds-index-js":["/component---src-pages-embeds-index-js-8b8dba1825aa400e5de9.js"],"component---src-pages-explore-index-js":["/component---src-pages-explore-index-js-bce31aa37ad1e05ba68e.js"],"component---src-pages-ide-index-js":["/component---src-pages-ide-index-js-4c0cb8f8c29fce243138.js"],"component---src-pages-jobs-index-js":["/component---src-pages-jobs-index-js-2ce65bf892fd03b76f13.js"],"component---src-pages-legal-index-js":["/component---src-pages-legal-index-js-4ee204853466194d73f1.js"],"component---src-pages-legal-privacy-js":["/component---src-pages-legal-privacy-js-f9c3ec1837bdbd58a431.js"],"component---src-pages-legal-terms-js":["/component---src-pages-legal-terms-js-3469368cfef72d826418.js"],"component---src-pages-pricing-index-js":["/component---src-pages-pricing-index-js-cab5a840d088ea406365.js"],"component---src-pages-react-hooks-js":["/component---src-pages-react-hooks-js-dfdda4edafb4eed10c39.js"],"component---src-pages-who-uses-codesandbox-js":["/component---src-pages-who-uses-codesandbox-js-49031ca42897ad9ee914.js"]};/*]]>*/</script><script src="/webpack-runtime-edbf8c97e8ef6830faf6.js" async=""></script><script src="/1-3a3464f5ff7af0c42398.js" async=""></script><script src="/3-68f281170fa1642b2afc.js" async=""></script><script src="/2-e46c10da8621f2227475.js" async=""></script><script src="/styles-ca0dba639b1e1a681fbe.js" async=""></script><script src="/app-a8a2381ab2d52452ce71.js" async=""></script><script src="/component---src-templates-post-js-85254caf75885945d366.js" async=""></script><script src="https://unpkg.com/docsearch.js@2.4.1/dist/cdn/docsearch.min.js" defer=""></script></body></html>